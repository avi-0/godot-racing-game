[gd_scene load_steps=21 format=3 uid="uid://7kidcw5bufnv"]

[ext_resource type="Script" uid="uid://b0tnrs7ikoyh4" path="res://scripts/Car.cs" id="1_qtbni"]
[ext_resource type="Script" uid="uid://dkdi4r3choyux" path="res://scripts/WheelConfig.cs" id="2_dg6r6"]
[ext_resource type="PackedScene" uid="uid://csskae458c73v" path="res://assets/kenney/carkit/race-future.glb" id="3_qtbni"]
[ext_resource type="Script" uid="uid://bcg12cbu11ls7" path="res://scripts/CarWheel.cs" id="4_xknhn"]
[ext_resource type="PackedScene" uid="uid://du0u6oshpc0ql" path="res://scenes/cars_extras/orbit_camera.tscn" id="5_8lcft"]
[ext_resource type="AudioStream" uid="uid://pg86qjlo7cjf" path="res://assets/audio/carsfx-1.wav" id="6_yrqru"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_hcdi7"]
friction = 0.5
bounce = 0.6

[sub_resource type="Curve" id="Curve_qtbni"]
_limits = [1.0, 4.0, 0.0, 1.0]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.79636365, 4), 0.0, 0.0, 0, 0, Vector2(1, 3.4314353), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_wofr7"]
_limits = [1.0, 8.0, 0.0, 1.0]
_data = [Vector2(0, 8), 0.0, -18.3019, 0, 0, Vector2(0.13090909, 2.071526), -2.9020495, -2.9020495, 0, 0, Vector2(1, 1.5523977), -0.34810984, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_xv7xt"]
_limits = [1.0, 2.0, 0.0, 1.0]
_data = [Vector2(0, 1), 0.0, 3.059838, 0, 0, Vector2(0.123636365, 1.7453302), 0.43696904, 0.43696904, 0, 0, Vector2(1, 2), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Resource" id="Resource_x43s4"]
script = ExtResource("2_dg6r6")
SpringStrength = 10000.0
SpringDamping = 300.0
SpringRest = 0.15
OverExtend = 0.0
WheelRadius = 0.21
IsDriveWheel = true
IsSteeringWheel = true
BaseGrip = 0.7
metadata/_custom_type_script = "uid://dkdi4r3choyux"

[sub_resource type="Curve" id="Curve_dg6r6"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Resource" id="Resource_cn2cu"]
script = ExtResource("2_dg6r6")
SpringStrength = 10000.0
SpringDamping = 300.0
SpringRest = 0.17
OverExtend = 0.0
WheelRadius = 0.21
IsDriveWheel = true
BaseGrip = 0.4
GripCurve = SubResource("Curve_dg6r6")
FullLoseGripOnSlip = true
metadata/_custom_type_script = "uid://dkdi4r3choyux"

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_dg6r6"]
points = PackedVector3Array(-0.57880366, 0.063328564, -1.3084351, 0.46828297, 0.45806175, 0.60077447, -0.5431868, 0, 1.2663236, -0.36775386, 0.5699571, -1.3507451, 0.56093705, 0.063328564, -1.3084351, -0.48614958, 0.45806175, 0.60077447, 0.5253202, 0, 1.2663236, 0.39207324, 0.5699571, -1.3507451, -0.57880366, 0.19008487, 1.3507451, -0.3453276, -1.110223e-16, -1.2663236, -0.0645511, 0.6135035, -0.2965702, -0.57880366, 0.485519, -1.0551043, 0.56093705, 0.19008487, 1.3507451, 0.56093705, 0.485519, -1.0551043, 0.5649819, 0, -0.47474736, -0.5828485, 0, -0.47474736, 0.35, 0.014327154, -1.2090261, 0.39207324, 0.5699571, -1.2661252, -0.36775386, 0.5699571, -1.2661252, 0.5397163, 0.23547634, -1.2597117)

[sub_resource type="SphereShape3D" id="SphereShape3D_wofr7"]
radius = 0.21

[sub_resource type="Gradient" id="Gradient_hcdi7"]
offsets = PackedFloat32Array(0, 0.026845638)
colors = PackedColorArray(0, 0, 0, 0.87058824, 0, 0, 0, 0.28627452)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_yi0kw"]
gradient = SubResource("Gradient_hcdi7")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_wofr7"]
gravity = Vector3(0, 0, 0)
color_ramp = SubResource("GradientTexture1D_yi0kw")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_xv7xt"]
transparency = 1
vertex_color_use_as_albedo = true

[sub_resource type="QuadMesh" id="QuadMesh_g5cig"]
material = SubResource("StandardMaterial3D_xv7xt")
size = Vector2(0.1, 0.3)
orientation = 1

[node name="Car" type="RigidBody3D" node_paths=PackedStringArray("OrbitCamera", "FrontCamera", "Wheels", "SkidMarks", "EngineSound")]
collision_layer = 2
mass = 35.0
physics_material_override = SubResource("PhysicsMaterial_hcdi7")
gravity_scale = 2.0
center_of_mass_mode = 1
center_of_mass = Vector3(0, -0.1, 0.1)
continuous_cd = true
linear_damp_mode = 1
linear_damp = 0.25
script = ExtResource("1_qtbni")
OrbitCamera = NodePath("OrbitCamera")
FrontCamera = NodePath("FrontCamera")
Wheels = [NodePath("WheelFL"), NodePath("WheelFR"), NodePath("WheelBL"), NodePath("WheelBR")]
SkidMarks = [NodePath("SkidMarks/GPUParticles3D"), NodePath("SkidMarks/GPUParticles3D2"), NodePath("SkidMarks/GPUParticles3D3"), NodePath("SkidMarks/GPUParticles3D4")]
Acceleration = 130
MaxSpeed = 70
BrakingSpeedMultiplier = 0.8
ReverseSpeedMultiplier = 0.2
TireTurnSpeed = 1.0
SteeringBaseDegrees = 5
SlippingTraction = 0.5
SlipThreshold = 0.14
UnslipThreshold = 1.6
DebugMode = true
AccelerationCurve = SubResource("Curve_qtbni")
SpeedSteeringCurve = SubResource("Curve_wofr7")
SpeedToPitchCurve = SubResource("Curve_xv7xt")
EngineSound = NodePath("EngineSoundPlayer")
FrontWheelConfig = SubResource("Resource_x43s4")
RearWheelConfig = SubResource("Resource_cn2cu")

[node name="race-future" parent="." instance=ExtResource("3_qtbni")]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0, 0, 0)

[node name="wheel-back-left" parent="race-future" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.35000002, 0.2857143, -0.93041015)

[node name="wheel-back-right" parent="race-future" index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.35000002, 0.2857143, -0.93041015)

[node name="wheel-front-left" parent="race-future" index="3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.35000002, 0.2857143, 0.5845459)

[node name="wheel-front-right" parent="race-future" index="4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.35000002, 0.2857143, 0.5845459)

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0, 0.14, -5.05338e-16)
shape = SubResource("ConvexPolygonShape3D_dg6r6")

[node name="WheelFL" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.33, 0.2, 0.40918213)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("4_xknhn")
IsFrontWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelFL"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, -0.085, 0, 0)
remote_path = NodePath("../../race-future/wheel-front-left")

[node name="WheelFR" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.33, 0.2, 0.40918213)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("4_xknhn")
IsFrontWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelFR"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0.085, 0, 0)
remote_path = NodePath("../../race-future/wheel-front-right")

[node name="WheelBL" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.33, 0.2, -0.6512871)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("4_xknhn")
IsRearWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelBL"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, -0.085, 0, 0)
remote_path = NodePath("../../race-future/wheel-back-left")

[node name="WheelBR" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.33, 0.2, -0.6512871)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("4_xknhn")
IsRearWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelBR"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0.085, 0, 0)
remote_path = NodePath("../../race-future/wheel-back-right")

[node name="SkidMarks" type="Node3D" parent="."]

[node name="GPUParticles3D" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="GPUParticles3D2" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="GPUParticles3D3" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="GPUParticles3D4" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="OrbitCamera" parent="." instance=ExtResource("5_8lcft")]

[node name="EngineSoundPlayer" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("6_yrqru")
bus = &"enginesounds"
playback_type = 1

[node name="FrontCamera" type="Camera3D" parent="."]
transform = Transform3D(-1, 0, -8.742278e-08, -5.614962e-10, 0.9999794, 0.0064227674, 8.742097e-08, 0.0064227674, -0.9999794, 0, 0.34432578, 0.6439826)

[editable path="race-future"]
