[gd_scene load_steps=20 format=3 uid="uid://crc2q38d8anpl"]

[ext_resource type="Script" uid="uid://b0tnrs7ikoyh4" path="res://scripts/Car.cs" id="1_micox"]
[ext_resource type="PackedScene" uid="uid://biodx1fq5tguf" path="res://assets/kenney/carkit/sedan-sports.glb" id="2_g5cig"]
[ext_resource type="Script" uid="uid://dkdi4r3choyux" path="res://scripts/WheelConfig.cs" id="2_glvfi"]
[ext_resource type="Script" uid="uid://bcg12cbu11ls7" path="res://scripts/CarWheel.cs" id="3_hcdi7"]
[ext_resource type="AudioStream" uid="uid://pg86qjlo7cjf" path="res://assets/audio/carsfx-1.wav" id="6_g5cig"]
[ext_resource type="PackedScene" uid="uid://du0u6oshpc0ql" path="res://scenes/cars_extras/orbit_camera.tscn" id="6_xv7xt"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_hcdi7"]
friction = 0.0
bounce = 0.1

[sub_resource type="Curve" id="Curve_hcdi7"]
_limits = [1.0, 4.0, 0.0, 1.0]
_data = [Vector2(0, 2.6287487), 0.0, 0.0, 0, 0, Vector2(0.24202128, 1), 0.0, 0.0, 0, 0, Vector2(1, 1.9834538), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_wofr7"]
_limits = [1.0, 8.0, 0.0, 1.0]
_data = [Vector2(0, 8), 0.0, -18.3019, 0, 0, Vector2(0.24468084, 4.3769383), -13.008701, -13.008701, 0, 0, Vector2(1, 1), -0.9904156, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_xv7xt"]
_limits = [1.0, 2.0, 0.0, 1.0]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 2), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Resource" id="Resource_x43s4"]
script = ExtResource("2_glvfi")
SpringStrength = 8000.0
SpringDamping = 500.0
SpringRest = 0.15
OverExtend = 0.05
WheelRadius = 0.21
IsSteeringWheel = true
BaseGrip = 0.55
metadata/_custom_type_script = "uid://dkdi4r3choyux"

[sub_resource type="Resource" id="Resource_cn2cu"]
script = ExtResource("2_glvfi")
IsDriveWheel = true
BaseGrip = 0.65
metadata/_custom_type_script = "uid://dkdi4r3choyux"

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_x43s4"]
points = PackedVector3Array(0.65, 0.24996082, 1.1249853, 0.6206049, 0.24996082, 1.1956245, 0.65, 0.049936373, 1.1249853, 0.65, 0.42571455, 0.96074283, 0.5499804, 0.24996082, 1.2248286, 0.6206049, 0.049936373, 1.1956245, 0.5499804, 0.4499853, 1.1749068, 0.12496084, 0, 1.275, 0.65, 0.049936373, -1.1252348, 0.65, 0.4877398, 0.8798698, 0.12496084, 0.17491679, 1.275, 0.17497063, 0.12498041, 1.275, 0.5499804, 0.049936373, 1.2248286, -0.55010766, 0.4499853, 1.1749068, 0.5499804, 0.5999804, 0.9247993, 0.17497063, 0.049936373, 1.275, -0.1250881, 0, 1.275, 0.12496084, 0, -1.275, 0.6206049, 0.049936373, -1.1958741, 0.65, 0.24996082, -1.1252348, 0.65, 0.5267032, 0.78576744, -0.1250881, 0.17491679, 1.275, -0.6207322, 0.24996082, 1.1956245, -0.55010766, 0.24996082, 1.2248286, -0.55010766, 0.5999804, 0.9247993, -0.65, 0.4877398, 0.8798698, -0.65, 0.42571455, 0.96074283, 0.65, 0.64991677, 0.44779754, 0.44996083, 0.9499999, 0.17497551, -0.17509788, 0.049936373, 1.275, -0.55010766, 0.049936373, 1.2248286, -0.6207322, 0.049936373, 1.1956245, -0.65, 0.049936373, 1.1249853, -0.1250881, 0, -1.275, 0.17497063, 0.049936373, -1.275, 0.5499804, 0.049936373, -1.2250783, 0.6206049, 0.24996082, -1.1958741, 0.5499804, 0.4499853, -1.2250783, 0.65, 0.42571455, -0.91082126, -0.17509788, 0.12498041, 1.275, -0.65, 0.24996082, 1.1249853, -0.65, 0.64991677, 0.44779754, -0.65, 0.5267032, 0.78576744, -0.45008808, 0.9499999, 0.17497551, 0.65, 0.64991677, 0.34770453, 0.44996083, 0.9499999, -0.52517617, -0.65, 0.049936373, -1.1252348, -0.6207322, 0.049936373, -1.1958741, -0.55010766, 0.049936373, -1.2250783, -0.17509788, 0.049936373, -1.275, 0.17497063, 0.12498041, -1.275, 0.12496084, 0.17491679, -1.275, -0.55010766, 0.4499853, -1.2250783, 0.5499804, 0.64991677, -0.82520556, 0.65, 0.4877398, -0.8301977, -0.65, 0.64991677, 0.34770453, -0.45008808, 0.9499999, -0.52517617, 0.65, 0.53990793, -0.6350039, 0.65, 0.5267032, -0.7360953, -0.65, 0.24996082, -1.1252348, -0.6207322, 0.24996082, -1.1958741, -0.17509788, 0.12498041, -1.275, -0.1250881, 0.17491679, -1.275, -0.65, 0.42571455, -0.91082126, -0.65, 0.4877398, -0.8301977, -0.55010766, 0.64991677, -0.82520556, -0.65, 0.53990793, -0.6350039, -0.65, 0.5267032, -0.7360953)

[sub_resource type="SphereShape3D" id="SphereShape3D_wofr7"]
radius = 0.21

[sub_resource type="Gradient" id="Gradient_hcdi7"]
offsets = PackedFloat32Array(0, 0.026845638)
colors = PackedColorArray(0, 0, 0, 0.87058824, 0, 0, 0, 0.28627452)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_yi0kw"]
gradient = SubResource("Gradient_hcdi7")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_wofr7"]
gravity = Vector3(0, 0, 0)
color_ramp = SubResource("GradientTexture1D_yi0kw")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_xv7xt"]
transparency = 1
vertex_color_use_as_albedo = true

[sub_resource type="QuadMesh" id="QuadMesh_g5cig"]
material = SubResource("StandardMaterial3D_xv7xt")
size = Vector2(0.1, 0.3)
orientation = 1

[node name="Car" type="RigidBody3D" node_paths=PackedStringArray("OrbitCamera", "Wheels", "SkidMarks", "EngineSound")]
collision_layer = 2
mass = 50.0
physics_material_override = SubResource("PhysicsMaterial_hcdi7")
center_of_mass_mode = 1
center_of_mass = Vector3(0, 0.1, 0)
continuous_cd = true
linear_damp_mode = 1
linear_damp = 0.25
script = ExtResource("1_micox")
OrbitCamera = NodePath("OrbitCamera")
Wheels = [NodePath("WheelFL"), NodePath("WheelFR"), NodePath("WheelBL"), NodePath("WheelBR")]
SkidMarks = [NodePath("SkidMarks/GPUParticles3D"), NodePath("SkidMarks/GPUParticles3D2"), NodePath("SkidMarks/GPUParticles3D3"), NodePath("SkidMarks/GPUParticles3D4")]
Acceleration = 300
MaxSpeed = 30
SteeringBaseDegrees = 4
SlippingTraction = 0.15
SlipThreshold = 0.8
UnslipThreshold = 0.8
AccelerationCurve = SubResource("Curve_hcdi7")
SpeedSteeringCurve = SubResource("Curve_wofr7")
SpeedToPitchCurve = SubResource("Curve_xv7xt")
EngineSound = NodePath("EngineSoundPlayer")
FrontWheelConfig = SubResource("Resource_x43s4")
RearWheelConfig = SubResource("Resource_cn2cu")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0, 0.105000004, -0.0175)
shape = SubResource("ConvexPolygonShape3D_x43s4")

[node name="sedan-sports" parent="." instance=ExtResource("2_g5cig")]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0, 0, 0)

[node name="wheel-back-left" parent="sedan-sports" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.35000002, 0.37431684, -0.6535253)

[node name="wheel-back-right" parent="sedan-sports" index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.35000002, 0.37431684, -0.6535253)

[node name="wheel-front-left" parent="sedan-sports" index="3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.35000002, 0.37431684, 0.68023473)

[node name="wheel-front-right" parent="sedan-sports" index="4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.35000002, 0.37431684, 0.68023473)

[node name="WheelFL" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.33, 0.26202178, 0.47616428)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("3_hcdi7")
IsFrontWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelFL"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, -0.085, 0, 0)
remote_path = NodePath("../../sedan-sports/wheel-front-left")

[node name="WheelFR" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.33, 0.26202178, 0.47616428)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("3_hcdi7")
IsFrontWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelFR"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0.085, 0, 0)
remote_path = NodePath("../../sedan-sports/wheel-front-right")

[node name="WheelBL" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.33, 0.26202178, -0.45746768)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("3_hcdi7")
IsRearWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelBL"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, -0.085, 0, 0)
remote_path = NodePath("../../sedan-sports/wheel-back-left")

[node name="WheelBR" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.33, 0.26202178, -0.45746768)
shape = SubResource("SphereShape3D_wofr7")
target_position = Vector3(0, 0, 0)
script = ExtResource("3_hcdi7")
IsRearWheel = true

[node name="RemoteTransform3D" type="RemoteTransform3D" parent="WheelBR"]
transform = Transform3D(0.7, 0, 0, 0, 0.7, 0, 0, 0, 0.7, 0.085, 0, 0)
remote_path = NodePath("../../sedan-sports/wheel-back-right")

[node name="SkidMarks" type="Node3D" parent="."]

[node name="GPUParticles3D" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="GPUParticles3D2" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="GPUParticles3D3" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="GPUParticles3D4" type="GPUParticles3D" parent="SkidMarks"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.034647346)
emitting = false
amount = 150
lifetime = 1.5
fixed_fps = 60
process_material = SubResource("ParticleProcessMaterial_wofr7")
draw_pass_1 = SubResource("QuadMesh_g5cig")

[node name="OrbitCamera" parent="." instance=ExtResource("6_xv7xt")]

[node name="EngineSoundPlayer" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("6_g5cig")
bus = &"enginesounds"
playback_type = 1

[editable path="sedan-sports"]
